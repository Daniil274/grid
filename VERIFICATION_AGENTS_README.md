# üß† –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ GRID

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ AI –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –∏ –Ω–µ–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

> **üîÑ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 
> - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `Runner.run()` —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏
> - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
> - ‚úÖ –í—Å–µ –ø—Ä–æ–º–ø—Ç—ã –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
> - ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü—Ä–æ–≤–µ—Ä—è—é—â–∏–µ –∞–≥–µ–Ω—Ç—ã –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ –∏ –æ—Ç—Å–µ–∏–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å —è–≤–Ω—ã–º–∏ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è–º–∏ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤—Ç–æ—Ä–∞—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã –ø–æ—Å–ª–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª –≤ –ø—Ä–æ–º–ø—Ç–∞—Ö.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **HallucinationChecker** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç-–æ—Ü–µ–Ω—â–∏–∫
2. **Output Guardrail** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –û—Å–Ω–æ–≤–Ω–æ–π –∞–≥–µ–Ω—Ç ‚Üí –û—Ç–≤–µ—Ç ‚Üí Output Guardrail ‚Üí HallucinationChecker ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç
                                                                    ‚Üì
                                                            –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/–ü—Ä–æ–ø—É—Å–∫
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```yaml
settings:
  verify_hallucinations: true  # –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≥–ª–æ–±–∞–ª—å–Ω–æ
  verification_agent: "hallucination_checker"  # –ê–≥–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
  verification_defaults:
    temperature: 0.1  # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞
    max_tokens: 1000  # –ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤
    context_strategy: "full"  # –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    confidence_threshold: 0.7  # –ü–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
    strict_mode: true  # –°—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≥–µ–Ω—Ç–æ–≤

```yaml
agents:
  assistant:
    verify_output: true  # –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–ª—è —ç—Ç–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
    verification_context: "full"  # –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    verification_settings:  # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
      temperature: 0.1
      strict_mode: true
```

### –ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π –∞–≥–µ–Ω—Ç

```yaml
agents:
  hallucination_checker:
    name: "–ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π –∞–≥–µ–Ω—Ç"
    model: "gpt-5-nano"
    base_prompt: "verification_base"
    verify_output: false  # –û—Ç–∫–ª—é—á–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É (–∏–∑–±–µ–≥–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏–∏)
    verification_settings:
      temperature: 0.1
      max_tokens: 1000
      confidence_threshold: 0.7
      strict_mode: true
```

### –ü—Ä–æ–º–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```yaml
prompt_templates:
  verification_base: |
    –¢—ã –∞–≥–µ–Ω—Ç-–æ—Ü–µ–Ω—â–∏–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π.
    
    –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, 
    —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ –æ–Ω —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º 
    –¥–∏–∞–ª–æ–≥–∞ –∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤—ã–∑–æ–≤–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.
    
    –ü–†–ê–í–ò–õ–ê –ü–†–û–í–ï–†–ö–ò:
    1. –ì–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è = —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è:
       - –°–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
       - –†–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤—ã–∑–æ–≤–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
       - –ü—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –≤ –¥–∏–∞–ª–æ–≥–µ
    
    2. –ù–ï —è–≤–ª—è–µ—Ç—Å—è –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–µ–π:
       - –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –≤—ã–≤–æ–¥—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–∫—Ç–æ–≤
       - –û–±—â–∏–µ –∑–Ω–∞–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∞—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç—É)
       - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    
    –í–ï–†–ù–ò –°–¢–†–£–ö–¢–£–†–ò–†–û–í–ê–ù–ù–´–ô –û–¢–í–ï–¢:
    - has_hallucination: true/false
    - analysis: –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ
    - confidence: —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å 0.0-1.0
    - flagged_statements: —Å–ø–∏—Å–æ–∫ –Ω–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π
```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–≥–µ–Ω—Ç–∞ —Å `verify_output: true` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è output guardrail:

```python
# –í AgentFactory.create_agent()
if (self.config.config.settings.verify_hallucinations and 
    getattr(agent_config, 'verify_output', False)):
    output_guardrails.append(hallucination_guardrail)
```

### –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```python
from core.verification_agents import HallucinationChecker

# –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞
checker = HallucinationChecker(model, config)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∞–≥–µ–Ω—Ç–∞
result = await checker.verify_response(
    response, 
    context, 
    context_strategy="full",
    agent_instructions="You are a file management agent"
)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∞–≥–µ–Ω—Ç–∞
result = await checker.verify_response(response, context)
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏

### HallucinationCheckOutput

```python
class HallucinationCheckOutput(BaseModel):
    has_hallucination: bool  # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ª–∏ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è
    analysis: str  # –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è
    confidence: float  # –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ä–µ—à–µ–Ω–∏–∏ (0.0-1.0)
    flagged_statements: List[str]  # –°–ø–∏—Å–æ–∫ –Ω–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π
```

### –õ–æ–≥–∏–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è

```python
# –í —Å—Ç—Ä–æ–≥–æ–º —Ä–µ–∂–∏–º–µ: –ª—é–±–∞—è –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è = —Ç—Ä–∏–ø–≤–∞–π–µ—Ä
if strict_mode:
    tripwire_triggered = verification_result.has_hallucination
else:
    # –í –Ω–µ—Å—Ç—Ä–æ–≥–æ–º —Ä–µ–∂–∏–º–µ: —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤—ã—à–µ –ø–æ—Ä–æ–≥–∞
    tripwire_triggered = (
        verification_result.has_hallucination and 
        verification_result.confidence >= confidence_threshold
    )
```

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä

```python
from core.agent_factory import AgentFactory
from core.config import Config

# –°–æ–∑–¥–∞–µ–º —Ñ–∞–±—Ä–∏–∫—É
config = Config("config.yaml")
factory = AgentFactory(config)

# –°–æ–∑–¥–∞–µ–º –∞–≥–µ–Ω—Ç–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
agent = await factory.create_agent("assistant")
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω output_guardrail
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –∏ –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
python -c "from core.verification_agents import HallucinationChecker; print('‚úÖ –ò–º–ø–æ—Ä—Ç —É—Å–ø–µ—à–µ–Ω')"

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
# (—Ñ–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤ —É–¥–∞–ª–µ–Ω—ã –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)
```

## üîç –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### `full` - –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
–ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π –∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –≤–µ—Å—å –¥–∏–∞–ª–æ–≥ –∏ –∏—Å—Ç–æ—Ä–∏—é –≤—ã–∑–æ–≤–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

### `last_turn` - –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ö–æ–¥
–ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π –∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å –∏ –æ—Ç–≤–µ—Ç.

## üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–º—É –∞–≥–µ–Ω—Ç—É –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

```python
# –í hallucination_guardrail
agent_instructions = getattr(agent, 'instructions', None)

verification_result = await checker.verify_response(
    response_text, 
    ctx.context,
    context_strategy,
    agent_instructions  # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
)
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–º—É –∞–≥–µ–Ω—Ç—É:
- –ü–æ–Ω–∏–º–∞—Ç—å —Ä–æ–ª—å –∏ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
- –õ—É—á—à–µ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç–≤–µ—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
- –í—ã—è–≤–ª—è—Ç—å –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ù–∏–∑–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞** (0.1) –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–∞
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã** (1000) –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–≥–æ –∞–≥–µ–Ω—Ç–∞
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** —á–µ—Ä–µ–∑ guardrails
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –ø–µ—Ä–µ–¥–∞—á–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∞–≥–µ–Ω—Ç–∞ –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ä–µ–∫—É—Ä—Å–∏–∏** - –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–π –∞–≥–µ–Ω—Ç –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–∞–º
- **Fallback —Ä–µ–∂–∏–º** - –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏** –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π Runner.run()
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ

```yaml
# –ì–ª–æ–±–∞–ª—å–Ω–æ
settings:
  verify_hallucinations: false

# –î–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
agents:
  my_agent:
    verify_output: false
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–æ–≥–æ—Å—Ç–∏

```yaml
verification_defaults:
  strict_mode: false  # –ú–µ–Ω–µ–µ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
  confidence_threshold: 0.9  # –í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏

```yaml
agents:
  hallucination_checker:
    model: "claude-haiku"  # –ë—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    verification_settings:
      temperature: 0.0  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å
      max_tokens: 500   # –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≤–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:

```
INFO - core.verification_agents - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: {...}
INFO - core.verification_agents - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –ø—Ä–æ–π–¥–µ–Ω–∞ –¥–ª—è –∞–≥–µ–Ω—Ç–∞ assistant
WARNING - core.verification_agents - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏—è –≤ –æ—Ç–≤–µ—Ç–µ –∞–≥–µ–Ω—Ç–∞: ...
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ guardrail

```python
try:
    output = await Runner.run(agent, message, ...)
except OutputGuardrailTripwireTriggered:
    return "‚ùå –û—Ç–≤–µ—Ç –æ—Ç–∫–ª–æ–Ω—ë–Ω: –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏"
```

### –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏

```python
# –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–≤–µ—Ç –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
return GuardrailFunctionOutput(
    output_info=None,
    tripwire_triggered=False
)
```

## üîÆ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –ù–æ–≤—ã–µ —Ç–∏–ø—ã –ø—Ä–æ–≤–µ—Ä–æ–∫

```python
@output_guardrail
async def fact_checking_guardrail(ctx, agent, output):
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–∫—Ç–æ–≤ –ø–æ –≤–Ω–µ—à–Ω–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º
    pass

@output_guardrail
async def safety_guardrail(ctx, agent, output):
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    pass
```

### –ú–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```python
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ + –≥–ª—É–±–æ–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
output_guardrails = [
    quick_hallucination_check,
    deep_fact_verification
]
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OpenAI Agents SDK Guardrails](https://github.com/openai/agents)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è guardrails](https://github.com/openai/agents/tree/main/examples)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ MCP](https://modelcontextprotocol.io/)

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (v2.0)

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ Runner.run()**
   - –£–±—Ä–∞–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç `instructions`
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ OpenAI Agents SDK

2. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∞–≥–µ–Ω—Ç–∞**
   - –ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π –∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
   - –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —Ä–æ–ª–∏
   - –ë–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π

3. **–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫**
   - –í—Å–µ –ø—Ä–æ–º–ø—Ç—ã –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
   - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —è–∑—ã–∫ –¥–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º OpenAI Agents SDK

4. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –ì–∏–±–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (full/last_turn)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

---

**üéâ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ GRID v2.0 –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É—é—Ç—Å—è –∏–∑ `config.yaml`, —Ö–∞—Ä–¥–∫–æ–¥ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω, 
–æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∞. 