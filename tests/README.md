# –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Grid

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∞–≥–µ–Ω—Ç–æ–≤ Grid, –≤–∫–ª—é—á–∞—é—â–∞—è –º–æ–¥—É–ª—å–Ω—ã–µ, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã.

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ config_test.yaml         # –¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≥–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ test_framework.py        # –ë–∞–∑–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ test_agents.py          # –¢–µ—Å—Ç—ã –∞–≥–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ test_tools.py           # –¢–µ—Å—Ç—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ test_context.py         # –¢–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
‚îú‚îÄ‚îÄ test_integration.py     # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ run_tests.py           # –ó–∞–ø—É—Å–∫–∞—é—â–∏–π —Å–∫—Ä–∏–ø—Ç
‚îî‚îÄ‚îÄ README.md              # –î–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install pytest pytest-asyncio

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Grid
pip install -r requirements.txt
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
python tests/run_tests.py

# –ò–ª–∏ —á–µ—Ä–µ–∑ pytest
pytest tests/ -v
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç–µ—Å—Ç–æ–≤

```bash
# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –∞–≥–µ–Ω—Ç–æ–≤
python tests/run_tests.py --type agents

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤  
python tests/run_tests.py --type tools

# –¢–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
python tests/run_tests.py --type integration

# –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
python tests/run_tests.py --verbose
```

## üìã –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. –¢–µ—Å—Ç—ã –∞–≥–µ–Ω—Ç–æ–≤ (`test_agents.py`)

–ü—Ä–æ–≤–µ—Ä—è—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–≥–µ–Ω—Ç–æ–≤:

- **–ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã**: –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–æ–≤, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–∞–∑–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã**: –†–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –∞–≥–µ–Ω—Ç–æ–≤
- **–¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**: –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**: End-to-end —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

```python
# –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –∞–≥–µ–Ω—Ç–∞
@pytest.mark.asyncio
async def test_simple_agent_response():
    async with TestEnvironment() as env:
        response = await env.agent_factory.run_agent(
            "test_simple_agent", 
            "–ü—Ä–∏–≤–µ—Ç!"
        )
        assert response is not None
```

### 2. –¢–µ—Å—Ç—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`test_tools.py`)

–ü—Ä–æ–≤–µ—Ä—è—é—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:

- **–§–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –ß—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å, –ø–æ–∏—Å–∫, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Git –æ–ø–µ—Ä–∞—Ü–∏–∏**: –°—Ç–∞—Ç—É—Å, –∫–æ–º–º–∏—Ç—ã, –≤–µ—Ç–∫–∏
- **MCP —Å–µ—Ä–≤–µ—Ä—ã**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- **–ê–≥–µ–Ω—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**: –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏

```python
# –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
@pytest.mark.asyncio
async def test_file_operations():
    result = await write_file("test.txt", "content")
    assert "—É—Å–ø–µ—à–Ω–æ" in result.lower()
```

### 3. –¢–µ—Å—Ç—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (`test_context.py`)

–ü—Ä–æ–≤–µ—Ä—è—é—Ç —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ, –æ—á–∏—Å—Ç–∫–∞, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- **–ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**: –ú–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏

```python
# –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
def test_context_retention():
    context_manager = ContextManager(max_history=10)
    context_manager.add_message("user", "–¢–µ—Å—Ç")
    assert len(context_manager.history) == 1
```

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (`test_integration.py`)

–ü—Ä–æ–≤–µ—Ä—è—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

- **–ü–æ–ª–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã**: End-to-end —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –∫–∞—Å–∫–∞–¥–Ω—ã–µ –æ—à–∏–±–∫–∏  
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã**: –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–†–µ–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏**: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

### –¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`config_test.yaml`)

–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```yaml
settings:
  default_agent: "test_simple_agent"
  max_history: 10
  max_turns: 5
  agent_timeout: 30
  debug: true
  mcp_enabled: false  # –û—Ç–∫–ª—é—á–µ–Ω–æ –¥–ª—è –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

# –¢–µ—Å—Ç–æ–≤—ã–µ –∞–≥–µ–Ω—Ç—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
agents:
  test_simple_agent:
    name: "–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Å—Ç–æ–π –∞–≥–µ–Ω—Ç"
    model: "test_model"
    tools: []
    
  test_file_agent:
    name: "–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª–æ–≤—ã–π –∞–≥–µ–Ω—Ç" 
    model: "test_model"
    tools: ["test_file_read", "test_file_write"]
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
export GRID_TEST_ENV=true
export GRID_LOG_LEVEL=DEBUG

# –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
export RUN_INTEGRATION_TESTS=1
export TEST_LMSTUDIO_HOST=localhost
export TEST_LMSTUDIO_PORT=1234
```

## üß™ –§—Ä–µ–π–º–≤–æ—Ä–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### TestEnvironment

–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞:

```python
async with TestEnvironment() as env:
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
    # - –í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
    # - –¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    # - –ú–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
    # - –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
    
    env.set_mock_responses(["–¢–µ—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç"])
    response = await env.agent_factory.run_agent("agent", "message")
```

### AgentTestCase

–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

```python
test_case = AgentTestCase("test_name", "agent_key", "description")

test_case.setup(lambda env: setup_test_data(env))
test_case.test(lambda env: test_basic_response(env, "agent", "message"))
test_case.teardown(lambda env: cleanup_test_data(env))

result = await test_case.run(env)
```

### AgentTestSuite

–ù–∞–±–æ—Ä—ã —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤:

```python
suite = AgentTestSuite("Suite Name")
suite.add_test(test_case1)
suite.add_test(test_case2)

results = await suite.run_all()
summary = suite.get_summary()
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
{
    "test_name": "basic_response_test",
    "success": True,
    "duration": 0.45,
    "step_results": [...],
    "warnings": []
}
```

### –°–≤–æ–¥–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

```
üìä –°–í–û–î–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
============================================================
‚úÖ AGENTS           | –ü—Ä–æ–π–¥–µ–Ω–æ:   5 | –û—à–∏–±–æ–∫:   0 | –í—Ä–µ–º—è:   2.34s
‚úÖ TOOLS            | –ü—Ä–æ–π–¥–µ–Ω–æ:   8 | –û—à–∏–±–æ–∫:   0 | –í—Ä–µ–º—è:   1.87s
‚úÖ CONTEXT          | –ü—Ä–æ–π–¥–µ–Ω–æ:   6 | –û—à–∏–±–æ–∫:   0 | –í—Ä–µ–º—è:   0.92s
‚úÖ INTEGRATION      | –ü—Ä–æ–π–¥–µ–Ω–æ:   3 | –û—à–∏–±–æ–∫:   0 | –í—Ä–µ–º—è:   4.12s
------------------------------------------------------------
‚úÖ –û–ë–©–ò–ô –ò–¢–û–ì:     | –ü—Ä–æ–π–¥–µ–Ω–æ:  22 | –û—à–∏–±–æ–∫:   0 | –í—Ä–µ–º—è:   9.25s
üìà –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: 100.0%
```

## üîß –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

### 1. –¢–µ—Å—Ç –∞–≥–µ–Ω—Ç–∞

```python
@pytest.mark.asyncio
async def test_new_agent_feature():
    async with TestEnvironment() as env:
        env.set_mock_responses(["Expected response"])
        
        response = await env.agent_factory.run_agent(
            "agent_key",
            "Test message"
        )
        
        assert response is not None
        assert "expected_content" in response.lower()
```

### 2. –¢–µ—Å—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

```python
@pytest.mark.asyncio
async def test_new_tool():
    from tools.new_tool import new_function
    
    result = await new_function("test_input")
    
    assert result is not None
    assert "success" in result.lower()
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç

```python
@pytest.mark.integration
@pytest.mark.asyncio
async def test_complex_workflow():
    async with TestEnvironment() as env:
        # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        env.create_test_file("input.txt", "test data")
        
        # –ú—É–ª—å—Ç–∏—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π –ø—Ä–æ—Ü–µ—Å—Å
        responses = [
            "Step 1 complete",
            "Step 2 complete", 
            "Workflow finished"
        ]
        env.set_mock_responses(responses)
        
        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
        final_result = await env.agent_factory.run_agent(
            "test_full_agent",
            "Execute complex workflow"
        )
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∏
        assert "finished" in final_result.lower()
```

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `TestEnvironment` –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
- –û—á–∏—â–∞–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –ù–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã –≤ unit-—Ç–µ—Å—Ç–∞—Ö

### 2. –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–æ–∫–∞–π—Ç–µ –≤–Ω–µ—à–Ω–∏–µ API –≤—ã–∑–æ–≤—ã
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –æ—Ç–≤–µ—Ç—ã
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤

### 3. –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ç–µ—Å—Ç–æ–≤
- –î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å–ª–æ–∂–Ω—ã–º —Ç–µ—Å—Ç–∞–º
- –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ –∫–ª–∞—Å—Å—ã

### 4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `pytest.mark.asyncio` –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –ö–µ—à–∏—Ä—É–π—Ç–µ —Ç—è–∂–µ–ª—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ setup
- –ó–∞–ø—É—Å–∫–∞–π—Ç–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å –º–∞—Ä–∫–µ—Ä–æ–º `@pytest.mark.slow`

## üö® –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –í–∫–ª—é—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```python
# –í —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
settings:
  debug: true
  agent_logging:
    enabled: true
    level: "full"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
context_info = env.agent_factory.get_context_info()
print(f"Messages: {context_info['message_count']}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π
executions = env.agent_factory.get_recent_executions(5)
for exec in executions:
    print(f"Agent: {exec.agent_name}, Status: {exec.error or 'OK'}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∫–æ–≤
mock_calls = env.get_mock_calls()
print(f"Mock calls: {len(mock_calls)}")
```

### –û–±—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–¢–µ—Å—Ç –∑–∞–≤–∏—Å–∞–µ—Ç**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–π–º–∞—É—Ç—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. **–ê–≥–µ–Ω—Ç –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –º–æ–¥–µ–ª–∏ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ø–æ–∫—Ä—ã—Ç–∏–µ

### –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ coverage
pip install coverage

# –ó–∞–ø—É—Å–∫ —Å –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º –ø–æ–∫—Ä—ã—Ç–∏—è
coverage run -m pytest tests/
coverage report -m
coverage html  # HTML –æ—Ç—á–µ—Ç
```

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–≥–µ–Ω—Ç–∞**: < 1 —Å–µ–∫—É–Ω–¥—ã
- **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –∞–≥–µ–Ω—Ç–∞**: < 5 —Å–µ–∫—É–Ω–¥ (—Å –º–æ–∫–∞–º–∏)
- **–ü–∞–º—è—Ç—å**: –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞—Ö
- **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 10+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

## üîÑ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### GitHub Actions

```yaml
name: Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.9
      
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          pip install pytest pytest-asyncio
      
      - name: Run tests
        run: python tests/run_tests.py
```

### –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ö—É–∫–∏

```bash
# pre-commit —Ö—É–∫
#!/bin/sh
python tests/run_tests.py --type unit
if [ $? -ne 0 ]; then
    echo "–¢–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—à–ª–∏. –ö–æ–º–º–∏—Ç –æ—Ç–º–µ–Ω–µ–Ω."
    exit 1
fi
```