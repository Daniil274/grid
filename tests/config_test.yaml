# Конфигурация для тестирования системы агентов Grid
# Изолированная тестовая среда с минимальными зависимостями

# Глобальные настройки для тестирования
settings:
  default_agent: "test_simple_agent"
  max_history: 10
  max_turns: 5
  agent_timeout: 30  # Короткий таймаут для тестов
  debug: true
  mcp_enabled: false  # Отключаем MCP для базовых тестов
  working_directory: "/tmp/grid_test"
  config_directory: "tests"
  allow_path_override: true
  agent_logging:
    enabled: true
    level: "basic"
    save_prompts: false
    save_conversations: false
    save_executions: false

# Тестовые провайдеры (моки)
providers:
  mock_provider:
    name: "mock_provider"
    base_url: "http://localhost:11434"
    api_key: "test-key"
    timeout: 10
    max_retries: 1
    streaming_enabled: false

# Тестовые модели
models:
  test_model:
    name: "test-model"
    provider: "mock_provider"
    temperature: 0.1
    max_tokens: 1000
    description: "Тестовая модель"

# Тестовые инструменты
tools:
  test_file_read:
    type: "function"
    name: "read_file"
    description: "Читает файл в тестовой среде"
    prompt_addition: "Используй read_file(filepath) для чтения тестовых файлов."
  
  test_file_write:
    type: "function"
    name: "write_file"
    description: "Записывает файл в тестовой среде"
    prompt_addition: "Используй write_file(filepath, content) для записи тестовых файлов."
  
  test_calculator:
    type: "function"
    name: "calculate"
    description: "Простой калькулятор для тестов"
    prompt_addition: "Используй calculate(expression) для математических вычислений."

  test_sub_agent:
    type: "agent"
    name: "call_test_sub_agent"
    description: "Вызывает тестового подагента"
    prompt_addition: "Используй call_test_sub_agent(task) для делегирования задач."
    context_strategy: "minimal"
    context_depth: 2
    include_tool_history: false

# Базовые тестовые промпты
prompt_templates:
  test_base: |
    Ты тестовый AI помощник. Отвечай кратко и точно.
    Работаешь в изолированной тестовой среде.
  
  test_with_tools: |
    Ты тестовый агент с доступом к инструментам.
    Всегда используй доступные инструменты для выполнения задач.
    Отвечай в формате: ДЕЙСТВИЕ -> РЕЗУЛЬТАТ

# Тестовые агенты
agents:
  # Простой агент без инструментов
  test_simple_agent:
    name: "Тестовый простой агент"
    model: "test_model"
    tools: []
    base_prompt: "test_base"
    description: "Простой агент для базового тестирования"
    mcp_enabled: false

  # Агент с файловыми инструментами
  test_file_agent:
    name: "Тестовый файловый агент"
    model: "test_model"
    tools: ["test_file_read", "test_file_write"]
    base_prompt: "test_with_tools"
    description: "Агент для тестирования файловых операций"
    mcp_enabled: false

  # Агент с калькулятором
  test_calculator_agent:
    name: "Тестовый агент-калькулятор"
    model: "test_model"
    tools: ["test_calculator"]
    base_prompt: "test_with_tools"
    description: "Агент для тестирования вычислений"
    mcp_enabled: false

  # Агент с подагентами
  test_coordinator_agent:
    name: "Тестовый координатор"
    model: "test_model"
    tools: ["test_sub_agent"]
    base_prompt: "test_with_tools"
    description: "Агент для тестирования координации подагентов"
    mcp_enabled: false

  # Подагент
  test_sub_agent:
    name: "Тестовый подагент"
    model: "test_model"
    tools: ["test_calculator"]
    base_prompt: "test_base"
    custom_prompt: |
      Ты подагент для выполнения делегированных задач.
      Выполняй только то, что просят, и возвращай краткий результат.
    description: "Подагент для тестирования делегирования"
    mcp_enabled: false

  # Агент с полным набором инструментов
  test_full_agent:
    name: "Тестовый полный агент"
    model: "test_model"
    tools: ["test_file_read", "test_file_write", "test_calculator", "test_sub_agent"]
    base_prompt: "test_with_tools"
    description: "Агент со всеми тестовыми инструментами"
    mcp_enabled: false

# Тестовые сценарии
scenarios:
  basic_test:
    agent: "test_simple_agent"
    description: "Базовое тестирование без инструментов"
  
  file_operations_test:
    agent: "test_file_agent"
    description: "Тестирование файловых операций"
  
  calculation_test:
    agent: "test_calculator_agent"
    description: "Тестирование вычислений"
  
  coordination_test:
    agent: "test_coordinator_agent"
    description: "Тестирование координации агентов"
  
  full_features_test:
    agent: "test_full_agent"
    description: "Полное функциональное тестирование"